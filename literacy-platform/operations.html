<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CORNERSTONE MTSS — Operation Builder</title>
    <link rel="stylesheet" href="style.css" />
    <script src="platform.js" defer></script>
    <script src="number-sense.js" defer></script>
  </head>

  <body class="numsense-page operations-page force-light look-35">
    <div class="numsense-header">
      <div>
        <h1><a href="index.html">CORNERSTONE MTSS</a></h1>
        <div class="numsense-subtitle">Operation Builder: strategy-first addition, subtraction, multiplication, division, and equation fluency.</div>
      </div>
      <nav class="header-actions" aria-label="Primary">
        <a class="link-btn" href="index.html">Home</a>
      </nav>
    </div>

    <main class="numsense-main">
      <section class="numsense-panel" aria-label="Session setup and questions">
        <div class="numsense-panel-header">
          <div>
            <h2>Operation Builder</h2>
            <div class="numsense-help">Target operation strategy and fluency with short, scored probes.</div>
          </div>
        </div>

        <div class="numsense-setup-grid" aria-label="Session setup">
          <label class="numsense-field">
            Grade band
            <select id="numsense-grade" aria-label="Grade band">
              <option value="K-2">K-2</option>
              <option value="3-5">3-5</option>
              <option value="6-8">6-8</option>
              <option value="9-12">9-12</option>
            </select>
          </label>
          <label class="numsense-field">
            Target domain
            <select id="numsense-domain" aria-label="Target domain">
              <option value="operations">Operations</option>
            </select>
          </label>
          <label class="numsense-field">
            Questions
            <select id="numsense-rounds" aria-label="Question count">
              <option value="8">8</option>
              <option value="10">10</option>
              <option value="12">12</option>
            </select>
          </label>
          <label class="numsense-field">
            Answer mode
            <select id="numsense-answer-mode" aria-label="Answer mode">
              <option value="both">Both</option>
              <option value="type">Type only</option>
              <option value="choice">Choices only</option>
            </select>
          </label>
          <button id="numsense-start" type="button" class="primary-btn numsense-start">Start Builder</button>
        </div>

        <div class="numsense-hud" aria-label="Scoreboard">
          <span class="numsense-hud-item">Correct: <strong id="numsense-correct">0</strong></span>
          <span class="numsense-hud-item">Streak: <strong id="numsense-streak">0</strong></span>
          <span class="numsense-hud-item">Remaining: <strong id="numsense-remaining">0</strong></span>
        </div>

        <article class="numsense-card" aria-live="polite">
          <div class="numsense-kicker" id="numsense-kicker">Ready</div>
          <h3 id="numsense-prompt">Press Start Builder to generate your first operations prompt.</h3>
          <p id="numsense-stem" class="numsense-stem"></p>
          <div id="numsense-options" class="numsense-options" aria-label="Answer choices"></div>
          <div class="numsense-answer-row" aria-label="Typed answer">
            <label class="numsense-answer-label" for="numsense-answer-input">Type answer</label>
            <input id="numsense-answer-input" class="numsense-answer-input" type="text" autocomplete="off" spellcheck="false" inputmode="decimal" placeholder="Type your answer…" />
            <button id="numsense-submit" type="button" class="primary-btn numsense-submit">Submit</button>
          </div>
          <div class="numsense-actions">
            <button id="numsense-hint" type="button" class="secondary-btn">Hint</button>
            <button id="numsense-skip" type="button" class="secondary-btn">Skip</button>
          </div>
          <div id="numsense-hint-text" class="numsense-hint-text"></div>
          <div id="numsense-feedback" class="numsense-feedback" aria-live="polite"></div>
        </article>
      </section>

      <section class="numsense-panel" aria-label="Live pulse and teacher support">
        <div class="numsense-panel-header">
          <div>
            <h2>Operations Pulse</h2>
            <div class="numsense-help">Track operation strengths/gaps and choose the next intervention move.</div>
          </div>
        </div>

        <div id="numsense-pulse" class="numsense-pulse">
          <p>Start a builder session to generate live operation signals.</p>
        </div>

        <div class="numsense-fun-card" aria-live="polite">
          <div class="numsense-fun-title">Fun Boost</div>
          <div id="numsense-fun" class="numsense-fun-copy">
            Age-matched jokes, facts, and quotes appear here after each reveal.
          </div>
        </div>

        <details class="numsense-coach">
          <summary>Teacher moves for next trial</summary>
          <ul id="numsense-coach-list">
            <li>Start the builder to unlock targeted operation coaching moves.</li>
          </ul>
        </details>

        <section class="numsense-manip-card" aria-label="Manipulative strategy studio">
          <div class="numsense-manip-header">
            <h3>Manipulative Studio</h3>
            <div class="numsense-manip-subtitle">Use base-10 blocks, arrays, and number lines to test operation strategies before submitting.</div>
          </div>
          <div class="numsense-manip-tool-row" role="tablist" aria-label="Manipulative tools">
            <button type="button" class="secondary-btn numsense-manip-tool is-active" data-manip-tool="base10">Base-10 Blocks</button>
            <button type="button" class="secondary-btn numsense-manip-tool" data-manip-tool="array">Arrays</button>
            <button type="button" class="secondary-btn numsense-manip-tool" data-manip-tool="line">Number Line</button>
          </div>

          <div class="numsense-manip-panel" data-manip-panel="base10">
            <div class="numsense-manip-drag-help">Drag blocks from the tray into the workspace. Tap a block to remove it.</div>
            <div class="numsense-base10-tray" aria-label="Base-10 drag tray">
              <button type="button" class="numsense-base10-piece hundred" data-base10-piece="hundreds" draggable="true">+100</button>
              <button type="button" class="numsense-base10-piece ten" data-base10-piece="tens" draggable="true">+10</button>
              <button type="button" class="numsense-base10-piece one" data-base10-piece="ones" draggable="true">+1</button>
            </div>
            <div class="numsense-manip-controls">
              <label class="numsense-field">
                Hundreds
                <input id="numsense-base10-hundreds" type="number" min="0" max="9" value="1" />
              </label>
              <label class="numsense-field">
                Tens
                <input id="numsense-base10-tens" type="number" min="0" max="15" value="2" />
              </label>
              <label class="numsense-field">
                Ones
                <input id="numsense-base10-ones" type="number" min="0" max="20" value="4" />
              </label>
              <button id="numsense-base10-reset" type="button" class="secondary-btn">Reset Blocks</button>
            </div>
            <div class="numsense-manip-summary">Total value: <strong id="numsense-base10-total">124</strong></div>
            <div id="numsense-base10-view" class="numsense-base10-view"></div>
          </div>

          <div class="numsense-manip-panel hidden" data-manip-panel="array">
            <div class="numsense-manip-controls">
              <label class="numsense-field">
                Rows
                <input id="numsense-array-rows" type="number" min="1" max="12" value="3" />
              </label>
              <label class="numsense-field">
                Columns
                <input id="numsense-array-cols" type="number" min="1" max="12" value="4" />
              </label>
              <button id="numsense-array-reset" type="button" class="secondary-btn">Reset Array</button>
            </div>
            <div class="numsense-manip-drag-help">Drag across chips to shade or unshade groups.</div>
            <div class="numsense-manip-summary">Array total: <strong id="numsense-array-total">12</strong></div>
            <div id="numsense-array-view" class="numsense-array-view"></div>
          </div>

          <div class="numsense-manip-panel hidden" data-manip-panel="line">
            <div class="numsense-manip-controls">
              <label class="numsense-field">
                Start
                <input id="numsense-line-start" type="number" min="-100" max="100" value="0" />
              </label>
              <label class="numsense-field">
                End
                <input id="numsense-line-end" type="number" min="-100" max="100" value="20" />
              </label>
              <label class="numsense-field">
                Jump
                <input id="numsense-line-step" type="number" min="1" max="20" value="2" />
              </label>
              <label class="numsense-field">
                Drag marker
                <input id="numsense-line-slider" type="range" min="0" max="20" value="8" step="1" />
              </label>
              <button id="numsense-line-back" type="button" class="secondary-btn">Jump Back</button>
              <button id="numsense-line-forward" type="button" class="secondary-btn">Jump Forward</button>
              <button id="numsense-line-reset" type="button" class="secondary-btn">Reset Line</button>
            </div>
            <div class="numsense-manip-summary">Current point: <strong id="numsense-line-current">8</strong></div>
            <div id="numsense-line-view" class="numsense-line-view"></div>
          </div>
        </section>

        <div class="numsense-note">
          Logs save to local browser storage and feed the Numeracy Pulse in <a href="teacher-report.html">Teacher Report</a>.
        </div>
      </section>
    </main>
  </body>
</html>
